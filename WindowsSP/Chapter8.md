# System Programming Chapter 8 : 프로세스 간 통신(IPC) 2
### 1. 핸들 테이블과 오브젝트 핸들의 상속
- 핸들 테이블의 이해
	> 앞서 설명한 내용과 동일 : 각 프로세스에 종속되어 독립적이며, 핸들|주소 쌍의 형태를 가짐
- 핸들 테이블의 상속
	- 핸들 테이블에는 상속여부라는 요소도 포함되어 구성되어 있음
		> `핸들 | 주소 | 상속여부`  의 형태
		>> 상속여부가 Y로 되어있는 항목은 그대로 자식 프로세스로 상속되어짐
	- 상속을 할지 말지 여부는 프로세스를 생성할 때 부여하는 인자를 통해서 결정할 수 있음
	- 핸들 상속여부 N, Y를 결정하는 방법
		- 리소스를 만들때 보안관련 구조체 `SECURITY_ATTRIBUTES`의 내부 `bInheritHandle`값을 설정하여 결정
- 핸들의 상속과 UC
	- 상속을 통해 상속여부가 Y인 핸들은 자식 프로세스의 핸들 테이블에 등록됨
		> 해당 커널 프로세스에 접근 가능한 프로세스가 늘어났으므로 UC는 1증가
- Pseudo핸들과 핸들의 중복
	- 가짜핸들(Pseudo) : 핸들테이블에 등록되지 않은 핸들
		> ex) 자기자신에 대한 핸들 : 실질적으로 핸들테이블에 등록되지 않으며 고정된 상수 값을 반환
	- 가짜핸들 정보를 상속하기 위해서 `DuplicateHandle`함수를 사용하여 핸들테이블에 직접 등록
		> 수행결과 자기자신에 대한 핸들정보가 저장됨에 따라서 서로 다른 핸들정보로 동일한 주소로 접근 가능한 중복된 값을 가지게 됨
		```c
		DuplicateHandle(
		source 프로세스 핸들,
		복사하려는 핸들,
		destination 프로세스 핸들,
		&val(destination 프로세스 핸들테이블에 복사된 핸들값이 저장될 공간)
		...
		)
		```
### 2. 파이프 방식의 IPC
- IPC별 특성
	-|메일슬롯|이름없는 파이프|이름있는 파이프
	:---:|:---:|:---:|:---:
	방향성|단방향, 브로드캐스팅|단방향|양방향
	통신범위|제한없음| 부모 자식 프로세스|제한 없음
	> 제한없음 : 서로 다른 컴퓨터 간에도 통신이 가능하다는 의미  
	> 이름 : 컴퓨터 고유한 이름을 의미
- 이름없는 파이프
	- `CreatePipe` 를 통해서 파이프를 생성하면 입구, 출구에 대한 핸들정보를 반환받을 수 있음
	- write, read를 통해서 각각 입구, 출구에 접근 가능
	- 자식 프로세스를 생성한 경우 핸들테이블을 상속하여 부모, 자식이 모두 입구, 출구에 접근가능해짐 --> 이런 방식으로 IPC 수행
- 이름있는 파이프 프로그래밍 모델
	- server와 client가 각각 존재
		1. server 단에서 `CreateNamePipe` 함수에 의해서 pipe생성
		1. `ConnectNamedPipe` 함수에 의해 연결 대기 상태로 전환
		1. client의 `CreateFile` 함수 호출에 의한 파이프 오픈(연결)
#### 3. 프로세스 환경변수
- 프로세스 환경변수의 구성
	> 각 프로세스 독립적인 메모리 공간에 저장됨
	- Key, Value 쌍의 형태로 구성되어 있음
	- 프로세스 생성 간 부모 프로세스에서 자식 프로세스로 환경변수 테이블 복사본을 넘겨주는 방식으로 통신을 하는 기법
		> 상속 과정에서 복사됨## 3. 프로세스 환경변수
